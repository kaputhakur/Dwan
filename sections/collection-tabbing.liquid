<link rel="stylesheet" href="{{ 'collection-tabbing.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'swiper.css' | asset_url }}">

<script src="{{ 'collection-tab.js'|asset_url }}"></script>
<script src="{{ 'swiper.js'|asset_url }}"></script>

{% style %}
  .section-{{section.id}}-padding{
    padding-top:{{section.settings.padding_top|times :0.75 | round:0}}px;
  padding-bottom:{{section.settings.padding_bottom|times :0.75 | round:0}}px;
  }
  @media screen and (min-width:750px){
   .section-{{section.id}}-padding{
    padding-top:{{section.settings.padding_top}}px;
  padding-bottom:{{section.settings.padding_bottom}}px;
  }
  }
{% endstyle %}
{%- if section.settings.enable_quick_add -%}
  {{ 'quick-add.css' | asset_url | stylesheet_tag }}
  <script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

<div class="{% if section.settings.width =='full-width'%}full-width{% else %} page-width{% endif %}">
  <div class="product-range-wrapper">
    {% if section.settings.title != blank %}
      <h2>{{ section.settings.title }}</h2>
    {% endif %}
    <div class="product-range-content">
      <div class="tabs">
        {% for block in section.blocks %}
          {% assign collection = collections[block.settings['slider-collection']] %}
          <div
            class="Tab-{{ section.id  }} tablinks {% if forloop.index == 1 %}active{% endif %}"
            data-id="Tab-{{ section.id  }}{{ forloop.index }}"
          >
            {% if block.settings.title != blank %}
              <h3>{{ block.settings.title }}</h3>
            {% endif %}
          </div>
        {% endfor %}
      </div>
      <div class="wrapper_tabcontent">
        {% for block in section.blocks %}
          <div
            id="Tab-{{ section.id  }}{{ forloop.index }}"
            class="TabContent-{{ section.id  }} tabcontent {% if forloop.index == 1 %}active{% endif %}"
          >
            <!-- -----------    ---------    ------ product silder-------------------------------- -->
            <div class="collection-carousel swiper">
              <div class="swiper-wrapper">
                {% assign collection = collections[block.settings['slider-collection']] %}
                {% for product in collection.products %}
                  <div class="featured-product swiper-slide">
                    {% render 'card-product',
                      card_product: product,
                      media_aspect_ratio: section.settings.image_ratio,
                      show_secondary_image: section.settings.show_secondary_image,
                      show_vendor: section.settings.show_vendor,
                      show_rating: section.settings.show_rating,
                      show_quick_add: section.settings.enable_quick_add,
                      section_id: section.id
                    %}
                    {%- assign product_form_id = 'product-form-' | append: section.id -%}

                    {%- for block in section.blocks -%}
                      {%- case block.type -%}
                        {%- when '@app' -%}
                          {% render block %}
                        {%- when 'variant_picker' -%}
                          {% render 'product-variant-picker',
                            product: product,
                            block: block,
                            product_form_id: product_form_id
                          %}
                        {%- when 'buy_buttons' -%}
                          {%- render 'buy-buttons',
                            block: block,
                            product: product,
                            product_form_id: product_form_id,
                            section_id: section.id,
                            show_pickup_availability: true
                          -%}
                      {%- endcase -%}
                    {% endfor %}
                    <div {{ block.shopify_attributes }}>
                      {%- assign product_form_installment_id = 'product-form-installment-' | append: section.id -%}
                      {%- form 'product',
                        product,
                        id: product_form_installment_id,
                        class: 'installment caption-large'
                      -%}
                        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                        {{ form | payment_terms }}
                      {%- endform -%}
                    </div>
                    <!-- ------------product-size-selector------------- -->

                    <div class="product-size-wrapper">
                      <div class="quick-ad">
                        <span>OUICK ADD +</span>
                      </div>
                      <div class="product-size-selector">
                        {% for option in product.options_with_values %}
                          {% if option.name == 'Size' %}
                            {% for value in option.values %}
                              <div class="size-selector">
                                <input
                                  class="single-size-selector"
                                  type="radio"
                                  id=""
                                  name="{{ option.name }}"
                                  value="{{ value | escape }}"
                                  {% if option.selected_value == value %}
                                    checked="true"
                                  {% endif %}
                                >
                                <label>{{ value }}</label>
                              </div>
                            {% endfor %}
                          {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                    <!-- ------------- product-size-selector-ende ------  ---- -- -->

                    <!-- ------------- product-color-selector------  ---- -- -->
                    <div class="product-color-selector">
                      {% for option in product.options_with_values %}
                        {% if option.name == 'Color' %}
                          <div class="product-variant-images ">
                            {% for value in option.values %}
                              {% for image in product.images %}
                                {% if image.alt == value %}
                                  <div class="variant-images">
                                    <img class="radius-5" src="{{ image.src | img_url:'60x60'}}">
                                  </div>
                                  {% break %}
                                {% endif %}
                              {% endfor %}
                            {% endfor %}
                          </div>
                        {% endif %}
                      {% endfor %}
                    </div>

                    <!-- ------------- product-color-selector-ende ------  ---- -- -->
                  </div>
                {% endfor %}
              </div>
            </div>

            <!-- ----------------------product silder end----- -------------------------------- -->
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    function isIE() {
      const ua = window.navigator.userAgent;
      const msie = ua.indexOf('MSIE ');
      const trident = ua.indexOf('Trident/');

      return msie > 0 || trident > 0;
    }

    if (!isIE()) return;
    const hiddenInput = document.querySelector('#{{ product_form_id }} input[name="id"]');
    const noScriptInputWrapper = document.createElement('div');
    const variantSwitcher =
      document.querySelector('variant-radios[data-section="{{ section.id }}"]') ||
      document.querySelector('variant-selects[data-section="{{ section.id }}"]');
    noScriptInputWrapper.innerHTML = document.querySelector(
      '.product-form__noscript-wrapper-{{ section.id }}'
    ).textContent;
    variantSwitcher.outerHTML = noScriptInputWrapper.outerHTML;

    document.querySelector('#Variants-{{ section.id }}').addEventListener('change', function (event) {
      hiddenInput.value = event.currentTarget.value;
    });
  });
</script>

{% schema %}
{
  "name": "Product Range Tab",
  "settings": [
      {
    "type": "select",
    "id": "width",
    "label": "Page width",
    "options": [
      {
        "value": "full-width",
        "label": "Full Width"
      },
      {
        "value": "page-width",
        "label": "Wrapper Width"
      },
      {
        "value": "narrow-width",
        "label": "Narrow width"
      }
    ]
  },
     {
      "type": "text",
      "id": "title",
      "label": "Heading"
    },
    {
      "type":"range",
      "label":"section top padding",
      "id":"padding_top",
      "max":100,
      "min":0,
      "unit":"px",
      "default":36
    },
     {
      "type":"range",
      "label":"section bottom padding",
      "id":"padding_bottom",
      "max":100,
      "min":0,
      "unit":"px",
      "default":36
    },
     {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.featured-collection.settings.image_ratio.options__1.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.featured-collection.settings.image_ratio.options__2.label"
        },
        {
          "value": "square",
          "label": "t:sections.featured-collection.settings.image_ratio.options__3.label"
        }
      ],
      "default": "adapt",
      "label": "t:sections.featured-collection.settings.image_ratio.label"
    },
    {
    "type": "checkbox",
    "id": "show_secondary_image",
    "default": false,
    "label": "t:sections.featured-collection.settings.show_secondary_image.label"
  },
    {
    "type": "checkbox",
    "id": "enable_quick_add",
    "default": false,
    "label": "t:sections.featured-collection.settings.enable_quick_buy.label"
  }

    ],
    "blocks":[
       {
      "type": "@app"
    },
    {
      "type":"content",
      "name":"content",
      "settings":[


         {
      "type": "collection",
      "id": "slider-collection",
      "label": "Collection"
     },
      {
      "type": "text",
      "id": "title",
      "label": "Block Title"
     }
     ]
     },
         {
    "type": "variant_picker",
    "name": "t:sections.main-product.blocks.variant_picker.name",
    "limit": 1,
    "settings": [
      {
        "type": "select",
        "id": "picker_type",
        "options": [
          {
            "value": "dropdown",
            "label": "t:sections.main-product.blocks.variant_picker.settings.picker_type.options__1.label"
          },
          {
            "value": "button",
            "label": "t:sections.main-product.blocks.variant_picker.settings.picker_type.options__2.label"
          }
        ],
        "default": "button",
        "label": "t:sections.main-product.blocks.variant_picker.settings.picker_type.label"
      }
    ]
  },
   {
      "type": "buy_buttons",
      "name": "t:sections.main-product.blocks.buy_buttons.name",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "default": true,
          "label": "t:sections.main-product.blocks.buy_buttons.settings.show_dynamic_checkout.label",
          "info": "t:sections.main-product.blocks.buy_buttons.settings.show_dynamic_checkout.info"
        },
        {
          "type": "checkbox",
          "id": "show_gift_card_recipient",
          "default": false,
          "label": "t:sections.main-product.blocks.buy_buttons.settings.show_gift_card_recipient.label",
          "info": "t:sections.main-product.blocks.buy_buttons.settings.show_gift_card_recipient.info"
        }
      ]
    }

  ],
  "presets":[
    {
      "name":"Product Rnge Tab"
    }
  ]
}
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
